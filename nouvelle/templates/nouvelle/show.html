{% extends 'layouts/base.html' %}
{% load markdown_deux_tags %}
{% block title %}{{ nouvelleecrite.titre }}{% endblock %}
{% block content %}


<div class="card  text-center border-0 nuage" >
	<div class="card-body">
		
		<blockquote class="blockquote mb-0">	
			<h3> 
				{{ nouvelleecrite.titre }} 
			</h3>

			<footer class="blockquote-footer" >
				<br>
				Régigé par {{ nouvelleecrite.auteur_nouvelle.profile.pseudo }}
				<cite style="margin-left: 20px;">
					{% if nombre_mots <= 1 %} {{ nombre_mots }} mot
					{% else %} {{ nombre_mots }} mots
					{% endif %}
				</cite> 
				<cite style="margin-left: 20px;">
					{% if nouvelleecrite.commentsection_set.count <= 1 %} {{ nouvelleecrite.commentsection_set.count }} commentaire
					{% else %} {{ nouvelleecrite.commentsection_set.count }} commentaires
					{% endif %}
				</cite> 
				<cite style="margin-left: 20px;">
					écrit le {{ nouvelleecrite.date|date:"DATE_FORMAT" }}
				</cite>
				<cite style="margin-left: 20px;">
					{% if nouvelleecrite.modification %}
						modifié le {{ nouvelleecrite.updated_at|date:"DATE_FORMAT" }}
					{% endif %} 
				</cite>
			</footer>

		</blockquote>
	</div>

</div>
<div class="card text-center border-0 nuage" >
	<div class="card-body">
		<br>
		{% if nouvelleecrite.contenu != '' %}
			<p>
				<br> 
				{{ nouvelleecrite.contenu|markdown }}
			</p>
		{% endif %}
		<br>
		{% if nouvelleecrite.auteur_nouvelle.profile.signature %}
			<p class="signature">{{ nouvelleecrite.auteur_nouvelle.profile.signature }}</p>
		{% endif %}
	</div>

	<p> 
		Vous avez aimé ? Faites le savoir ! 
		<br>
		Smash that button
		<a class='like-btn' data-href="{{ nouvelleecrite.get_like_api_url }}" href="{{ nouvelleecrite.get_like_url }}" position-photo="{{ MEDIA_URL }}" name-photo="{{ nouvelleecrite.slug }}">
			{{ nouvelleecrite.likes.count }} 
		    {% if user in nouvelleecrite.likes.all %}
		        <img style="height:25px;margin-bottom: 7px;" src="{{ MEDIA_URL }}image_site/like_button.png">
		    {% else %}
		        <img style="height:25px;margin-bottom: 7px;" src="{{ MEDIA_URL }}image_site/no_like_button.png">
		    {% endif %}
		</a>  
		<img id="{{ nouvelleecrite.slug }}" style="height:25px;margin-bottom: 7px; display: none" src="{{ MEDIA_URL }}image_site/like_button.png">
		<br>
		<div style="margin-top: -23px;">Or leave a comment !</div>  
		{% if user.is_authenticated == False %}
			<br>
			<div>Mais pour pouvoir faire tout ça, il faut vous enregistrer et c'est pas bien compliqué, car ça se passe juste <a href="{% url 'connexion:connexion' %}">là</a></div>  
		{% endif %}
	</p>
	<p id="commentaire_auteur" style="font-weight: bold">
		Informations additionnelles de l'auteur
	</p>
	<p id="confirmation_commentaire_auteur" style="display: none">Etes-vous sur de vouloir regarder ce qu'a pu ajouter l'auteur ? Ce ne sont que des informations additionnelles qui ne font pas parti de la nouvelle. Je ne saurai trop vous conseiller de revenir lire cette partie lorsque vous vous serez fait une idée personnelle de cette nouvelle avec votre interprétation pour qu'ensuite vous la confrontriez avec celle de l'auteur. 

		Si c'est déjà fait ou si vous êtes un petit rebelle ne faisant fi de mes recommendations, et bien cliquez <span id="confirmation_commentaire_auteur_ok" style="font-weight: bold; display: none">Ici</span></p>
	<div id="commentaire_auteur_show" style="display: none" > YO
		{{ nouvelleecrite.information_additionnelle|markdown }} 
	</div>
</div>
{% if user.username == nouvelleecrite.auteur_nouvelle or user.is_superuser %}
	<a class="btn btn-outline-primary" href="{% url 'nouvelle:nouvelle-update' nouvelleecrite.id nouvelleecrite.slug %}">Modifier la nouvelle</a>
	<a class="btn btn-outline-danger" href="{% url 'nouvelle:nouvelle-delete' nouvelleecrite.id nouvelleecrite.slug %}">Supprimer la nouvelle</a>
	<br>
	<br>
{% endif %}

{% if user.is_authenticated %}
<br>
<form method="post" enctype="multipart/form-data" novalidate>
    {% csrf_token %}
    {% include './form_help_local.html' with form=form particular_field='Comment' particular_placeholder="Vient me faire disparaitre en laissant un commentaire ;)" particular_label_tag="" %}
    <input type="submit" name="laisser_commentaire" value="Envoyer" />
</form>
{% endif %}


<br>
<a href="{% url 'nouvelle:index' %}">Retour à l'index </a>
{% endblock %}

